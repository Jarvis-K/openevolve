# 岛屿状态与学习曲线可视化功能

本文档介绍了为OpenEvolve可视化器新增的岛屿状态监控和学习曲线分析功能。

## 🏝️ 岛屿状态可视化

### 功能概述
- **实时监控**：显示每个演化岛屿的当前状态
- **关键指标**：人口数量、代数、最佳分数、平均分数
- **当前岛屿标识**：高亮显示正在活跃演化的岛屿
- **程序链接**：点击可查看岛屿中的最佳程序

### 界面特性
- 网格布局显示所有岛屿
- 颜色编码状态指示器（绿色=活跃，红色=空闲）
- 当前岛屿带有特殊边框和标识
- 响应式设计，适配不同屏幕尺寸

### 数据来源
- 从检查点元数据中提取岛屿信息
- 实时计算每个岛屿的统计数据
- 支持多岛屿并行演化的监控

## 📈 学习曲线可视化

### 功能概述
- **演化趋势**：显示最佳分数随迭代步数的变化
- **交互式图表**：基于D3.js的高质量可视化
- **代码查看**：点击曲线上的点即可查看对应的程序代码
- **累积最佳**：显示到目前为止的最佳分数演进

### 交互功能
- **鼠标悬停**：显示详细的迭代信息和分数
- **点击查看代码**：点击数据点自动显示对应程序的完整代码
- **平滑滚动**：自动滚动到代码查看区域
- **网格线**：辅助读取精确数值

### 技术特性
- 阶梯式曲线显示（因为最佳分数在迭代间保持）
- 自适应坐标轴范围
- 响应式图表尺寸
- 深色主题支持

## 🚀 使用方法

### 1. 启动可视化器
```bash
python scripts/visualizer.py --path your_experiment_path --port 8080
```

### 2. 访问新功能
在浏览器中打开 `http://localhost:8080`，然后：
- 点击 **"Islands"** 标签查看岛屿状态
- 点击 **"Learning Curve"** 标签查看学习曲线

### 3. 测试脚本
```bash
python test_island_viz.py --path examples/circle_packing/
```

## 📊 数据结构

### 岛屿统计数据
```json
{
  "island_id": 0,
  "population_size": 25,
  "best_score": 0.8543,
  "average_score": 0.7234,
  "generation": 15,
  "best_program_id": "abc123...",
  "is_current": true
}
```

### 学习曲线数据点
```json
{
  "iteration": 42,
  "score": 0.8543,
  "program_id": "abc123...",
  "code": "def optimized_function():\n    ...",
  "metrics": {
    "combined_score": 0.8543,
    "accuracy": 0.92,
    "efficiency": 0.78
  }
}
```

## 🎨 界面设计

### 岛屿视图特性
- **卡片式布局**：每个岛屿显示为独立的信息卡片
- **状态指示器**：彩色圆点显示岛屿活跃状态
- **当前岛屿高亮**：蓝色边框和"Current"标识
- **悬停效果**：鼠标悬停时卡片轻微上浮

### 学习曲线特性
- **专业图表**：使用D3.js绘制的高质量图表
- **交互提示**：悬停显示详细信息的工具提示
- **代码查看器**：点击后展开的代码显示区域
- **语法高亮**：程序代码的清晰显示

## 🔧 技术实现

### 后端改进
- `calculate_island_stats()`: 计算岛屿统计信息
- `generate_learning_curve()`: 生成学习曲线数据
- 扩展了数据API以包含新的可视化数据

### 前端模块
- `islands.js`: 岛屿可视化逻辑
- `learning-curve.js`: 学习曲线交互功能
- 集成到现有的标签页系统中

### 样式设计
- CSS变量支持深色/浅色主题切换
- 响应式网格布局
- 平滑的过渡动画效果

## 🎯 应用场景

### 研究人员
- **演化分析**：观察不同岛屿的演化策略效果
- **收敛监控**：通过学习曲线判断演化是否收敛
- **参数调优**：根据岛屿表现调整演化参数

### 算法开发者
- **性能评估**：快速识别最佳演化代码
- **调试支持**：定位特定迭代的程序状态
- **比较分析**：对比不同岛屿的演化路径

### 教育用途
- **可视化教学**：直观展示演化算法的工作原理
- **实验分析**：学生可以观察参数变化对演化的影响
- **案例研究**：通过真实数据理解岛屿模型

## 🚧 未来改进

### 计划中的功能
- **岛屿间迁移可视化**：显示程序在岛屿间的迁移路径
- **实时更新**：WebSocket支持的实时数据推送
- **导出功能**：将图表导出为PNG/SVG格式
- **高级筛选**：按分数范围、时间段筛选数据

### 性能优化
- **数据缓存**：避免重复计算统计数据
- **懒加载**：大数据集的分页加载
- **虚拟化**：大量数据点的高效渲染

## 📝 注意事项

1. **数据依赖**：需要包含岛屿元数据的检查点文件
2. **浏览器兼容**：推荐使用现代浏览器（Chrome、Firefox、Safari）
3. **性能考虑**：大量数据点可能影响渲染性能
4. **内存使用**：学习曲线数据会缓存在内存中

## 🤝 贡献

欢迎对这些新功能提出改进建议和bug报告。请通过GitHub Issues或Pull Requests参与贡献。